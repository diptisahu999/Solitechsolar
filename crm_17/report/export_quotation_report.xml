<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="export_quotation_report">
            <t t-call="web.basic_layout">
                <t t-foreach="docs" t-as="o">
                    <style>
                        .excel-table {
                            width: 100%;
                            border-collapse: collapse;
                            font-family: Arial, sans-serif;
                        }
                        .excel-table td, .excel-table th {
                            border: 1px solid #000;
                            padding: 4px 8px;
                            font-size: 11px;
                        }
                        .header-blue {
                            background-color: #4472C4;
                            color: white;
                            font-weight: bold;
                            text-align: center;
                            font-size: 16px;
                            padding: 10px;
                        }
                        .section-header {
                            background-color: #D9D9D9;
                            font-weight: bold;
                            text-align: center;
                            font-size: 12px;
                        }
                        .label-cell {
                            background-color: #F2F2F2;
                            font-weight: bold;
                            width: 15%;
                        }
                        .value-cell {
                            background-color: white;
                        }
                        .product-header {
                            background-color: #626362ff;
                            color: white;
                            font-weight: bold;
                            text-align: center;
                        }
                        .terms-header {
                            background-color: #626362ff;
                            font-weight: bold;
                            text-align: center;
                        }
                        .signature-box {
                            border: 1px solid #000;
                            min-height: 80px;
                            padding: 5px;
                            margin-top: 20px;
                        }
                        .page-break {
                            page-break-after: always;
                        }
                        .no-border {
                            border: none !important;
                        }
                        .text-center {
                            text-align: center;
                        }
                        .text-right {
                            text-align: right;
                        }
                        .bold {
                            font-weight: bold;
                        }
                        .note-content p {
                            margin: 0;
                        }
                        .page {
                            position: relative; /* Essential: makes 'position: absolute' in report-footer relative to the page */
                            min-height: 297mm; /* Assuming standard A4 height to help with positioning */
                            padding-bottom: 70px; /* Add padding at the bottom to reserve space for the footer */
                        }
                        .report-footer {
                            position: absolute;
                            bottom: -10px;
                            width: calc(100% - 16px); /* Adjust width based on page left/right margins (8px default on each side) */
                            box-sizing: border-box;
                        }
                    </style>

                    <div class="page">
                        <t t-set="print_type" t-value="env.context.get('print_type')"/>

                            <table style="width: 100%; border-collapse: collapse; font-family: Arial, sans-serif;">
                                <tr>
                                    <td style="width: 15%; text-align: left; vertical-align: top; height: 120%;" rowspan="3">
                                        
                                        <t t-if="print_type == 'quotation'">
                                            <img t-if="o.company_id.quotation_invoice_image" 
                                                t-att-src="image_data_uri(o.company_id.quotation_invoice_image)" 
                                                style="max-height: 85px; display: block;"/>
                                        </t>

                                        <t t-else="">
                                            <img t-if="o.company_id.sale_image" 
                                                t-att-src="image_data_uri(o.company_id.sale_image)" 
                                                style="max-height: 85px; display: block;"/>
                                        </t>   
                                    </td>
                                    <td style="width: 16%; font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Document No</td>
                                    <td style="width: 16%; font-size: 10px; border: 1px solid black; padding: 4px;">
                                        <span t-esc="o.name"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Issue Date</td>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px;">
                                        <span t-esc="o.date_order.strftime('%d-%m-%Y') if o.date_order else ''"/>
                                    </td>
                                </tr>

                                <tr>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Effective Date</td>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px;">
                                        <span t-esc="o.validity_date.strftime('%d-%m-%Y') if o.validity_date else ''"/>
                                    </td>
                                </tr>
                            </table>


                            <!-- Company Details Section -->
                            <table class="excel-table" style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td colspan="6" class="section-header">Company Details</td>
                                </tr>
                                <tr>
                                    <td class="label-cell" style="width: 4%;">Names</td>
                                    <td class="value-cell" style="width: 30%;"><t t-esc="o.company_id.name"/></td>

                                    <td class="label-cell">GSTIN No</td>
                                    <td class="value-cell"><t t-esc="o.company_id.vat or ''"/></td>

                                    <td class="label-cell">Quotation #</td>
                                    <td class="value-cell"><t t-esc="o.name"/></td>
                                </tr>
                                <tr>
                                    <td class="label-cell" style="width: 4%;">Address</td>
                                    <td class="value-cell" style="width: 30%;">
                                        <t t-if="o.company_id.street"><t t-esc="o.company_id.street"/>, </t>
                                        <t t-if="o.company_id.street2"><t t-esc="o.company_id.street2"/>, </t>
                                        <t t-if="o.company_id.city"><t t-esc="o.company_id.city"/>, </t>
                                        <t t-if="o.company_id.state_id"><t t-esc="o.company_id.state_id.name"/>, </t>
                                        <t t-if="o.company_id.zip"><t t-esc="o.company_id.zip"/></t>
                                    </td>

                                    <td class="label-cell">Sales Person</td>
                                    <td class="value-cell"><t t-esc="o.user_id.name if o.user_id else ''"/></td>

                                    <td class="label-cell">Quotation Date</td>
                                    <td class="value-cell"><t t-esc="o.date_order.strftime('%d-%m-%Y') if o.date_order else ''"/></td>
                                </tr>
                                <tr>
                                    <td class="label-cell">Contact No</td>
                                    <td class="value-cell"><t t-esc="o.salesperson_phone or ''"/></td>

                                    <td class="label-cell">Email ID</td>
                                    <td class="value-cell"><t t-esc="o.company_id.email or ''"/></td>

                                    <td class="label-cell">Customer Reference</td>
                                    <td class="value-cell"><t t-esc="o.client_order_ref or ''"/></td>
                                </tr>
                            </table>

                            <!-- Customer Details Section -->
                            <table class="excel-table" style="width:100%; border-collapse: collapse; margin-top: 0px;">
                                <colgroup>
                                    <col style="width:12%;"/>
                                    <col style="width:21%;"/>
                                    <col style="width:12%;"/>
                                    <col style="width:21%;"/>
                                    <col style="width:12%;"/>
                                    <col style="width:22%;"/>
                                </colgroup>

                                <tr>
                                    <td colspan="6" class="section-header">Customer Details</td>
                                </tr>
                                <tr>
                                    <td class="label-cell">Bill To</td>
                                    <td colspan="2" class="value-cell">
                                        <t t-esc="o.partner_id.name"/>
                                    </td>
                                    <td class="label-cell">Ship To</td>
                                    <td colspan="2" class="value-cell">
                                        <t t-esc="o.partner_shipping_id.name if o.partner_shipping_id else o.partner_id.name"/>
                                    </td>
                                </tr>
                                <tr style="height:60px;">
                                    <td colspan="3" class="value-cell" style="height:60px; vertical-align:top;">
                                        <t t-if="o.partner_id.street"><t t-esc="o.partner_id.street"/>,</t>
                                        <t t-if="o.partner_id.street2"><t t-esc="o.partner_id.street2"/>,</t><br/>
                                        <t t-if="o.partner_id.city"><t t-esc="o.partner_id.city"/>,</t>
                                        <t t-if="o.partner_id.state_id"><t t-esc="o.partner_id.state_id.name"/>,</t>
                                        <t t-if="o.partner_id.zip"><t t-esc="o.partner_id.zip"/></t>
                                    </td>
                                    <td colspan="3" class="value-cell" style="height:60px; vertical-align:top;">
                                        <t t-if="o.partner_shipping_id">
                                            <t t-if="o.partner_shipping_id.street"><t t-esc="o.partner_shipping_id.street"/>,</t>
                                            <t t-if="o.partner_shipping_id.street2"><t t-esc="o.partner_shipping_id.street2"/>,</t><br/>
                                            <t t-if="o.partner_shipping_id.city"><t t-esc="o.partner_shipping_id.city"/>,</t>
                                            <t t-if="o.partner_shipping_id.state_id"><t t-esc="o.partner_shipping_id.state_id.name"/>,</t>
                                            <t t-if="o.partner_shipping_id.zip"><t t-esc="o.partner_shipping_id.zip"/></t>
                                        </t>
                                        <t t-if="not o.partner_shipping_id">
                                            <t t-if="o.partner_id.street"><t t-esc="o.partner_id.street"/>,</t>
                                            <t t-if="o.partner_id.street2"><t t-esc="o.partner_id.street2"/>,</t><br/>
                                            <t t-if="o.partner_id.city"><t t-esc="o.partner_id.city"/>,</t>
                                            <t t-if="o.partner_id.state_id"><t t-esc="o.partner_id.state_id.name"/>,</t>
                                            <t t-if="o.partner_id.zip"><t t-esc="o.partner_id.zip"/></t>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label-cell">GSTIN No</td>
                                    <td class="value-cell"><span t-field="o.partner_id.vat"/></td>
                                    <td class="label-cell">Contact Person</td>
                                    <td class="value-cell"><t t-esc="(o.partner_shipping_id or o.partner_id).name"/></td>
                                    <td colspan="2" class="label-cell">
                                        Supply Timeline Requirement
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label-cell">PAN No</td>
                                    <td class="value-cell"><span t-field="o.partner_id.l10n_in_pan"/></td>
                                    <td class="label-cell">Contact No</td>
                                    <td class="value-cell"><t t-esc="(o.partner_shipping_id or o.partner_id).phone"/></td>
                                    <td class="label-cell">Delivery Start Date</td>
                                    <td class="value-cell">
                                        <span t-field="o.start_date" t-options='{"widget": "date", "format": "dd-MM-yyyy"}'/>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label-cell">CIN No</td>
                                    <td class="value-cell"><span t-field="o.partner_id.company_registry"/></td>
                                    <td class="label-cell">Email ID</td>
                                    <td class="value-cell"><t t-esc="(o.partner_shipping_id or o.partner_id).email"/></td>
                                    <td class="label-cell">Delivery End Date</td>
                                    <td class="value-cell"><span t-field="o.commitment_date" t-options='{"widget": "date", "format": "dd-MM-yyyy"}'/></td>
                                </tr>
                            </table>

                            <!-- Product & Pricing Details -->
                            <table class="excel-table" style="width:100%; border-collapse:collapse;">
                                <thead>
                                    <tr>
                                        <td colspan="13" class="section-header">Product &amp; Pricing Details</td>
                                    </tr>
                                    <tr class="label-cell">
                                        <td class="label-cell" style="width: 4%;">Sr #</td>
                                        <td class="label-cell" colspan="2" style="width: 12%;">Model No</td>
                                        <td class="label-cell" style="width: 7%;">HSN Code</td>
                                        <td class="label-cell" style="width: 7%;">Wattage (Wp)</td>
                                        <td class="label-cell" style="width: 10%;">Unit Price (₹ per Wp)</td>
                                        <td class="label-cell" style="width: 10%;">Unit Price (₹ per Nos)</td>
                                        <td class="label-cell" style="width: 6%;">Quantity (Nos)</td>
                                        <td class="label-cell" style="width: 6%;">Quantity (MW)</td>
                                        <td class="label-cell" style="width: 12%;">Total Line Amount (₹)</td>
                                        <td class="label-cell" style="width: 5%;">GST Rate (%)</td>
                                        <td class="label-cell" style="width: 7%;">GST Amount (₹)</td>
                                        <td class="label-cell" style="width: 14%;">Total Amount (₹)</td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-set="line_no" t-value="1"/>
                                    <t t-set="total_qty" t-value="0"/>
                                    <t t-set="total_mw" t-value="0"/>
                                    <t t-set="calculated_untaxed" t-value="0"/>
                                    <t t-set="calculated_tax_amount" t-value="0"/>
                                    <t t-set="calculated_total" t-value="0"/>

                                    <t t-foreach="o.order_line" t-as="line">
                                        <t t-if="not line.display_type and not line.product_id.extra_charges">
                                            <tr>
                                                <td class="value-cell text-center"><t t-esc="line_no"/></td>

                                                <!-- ✅ Model No Column -->
                                                <td class="value-cell" colspan="2">
                                                    <t t-set="model_no_value" t-value="''"/>
                                                    <t t-if="line.product_id.product_template_attribute_value_ids">
                                                        <t t-foreach="line.product_id.product_template_attribute_value_ids" t-as="attribute_value">
                                                            <t t-if="attribute_value.attribute_id.name == 'Model No'">
                                                                <t t-set="model_no_value" t-value="attribute_value.name"/>
                                                            </t>
                                                        </t>
                                                    </t>
                                                    <!-- fallback to product name if model no not found -->
                                                    <t t-esc="model_no_value or line.product_id.name"/>
                                                </td>

                                                <td class="value-cell text-center"><t t-esc="line.product_id.l10n_in_hsn_code or ''"/></td>
                                                <td class="value-cell text-center"><t t-esc="line.wattage"/></td>
                                                <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'%.2f' % line.price_unit"/></td>
                                                <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'%.2f' % line.unit_price_per_nos"/></td>
                                                <td class="value-cell text-center"><t t-esc="'%.0f' % line.product_uom_qty"/></td>
                                                <td class="value-cell text-center"><t t-esc="'%.2f' % ((line.product_uom_qty * line.wattage) / 1000000)"/></td>
                                                <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'{:,.2f}'.format(line.price_subtotal)"/></td>

                                                <!-- ✅ Tax Percentage -->
                                                <td class="value-cell text-center">
                                                    <t t-set="tax_rate" t-value="0"/>
                                                    <t t-foreach="line.tax_id" t-as="tax">
                                                        <t t-if="tax.amount_type == 'group'">
                                                            <t t-foreach="tax.children_tax_ids" t-as="child_tax">
                                                                <t t-set="tax_rate" t-value="tax_rate + child_tax.amount"/>
                                                            </t>
                                                        </t>
                                                        <t t-else="">
                                                            <t t-set="tax_rate" t-value="tax_rate + tax.amount"/>
                                                        </t>
                                                    </t>
                                                    <t t-esc="'%.0f' % tax_rate"/>%
                                                </td>

                                                <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'{:,.2f}'.format(line.price_total - line.price_subtotal)"/></td>
                                                <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'{:,.2f}'.format(line.price_total)"/></td>
                                            </tr>

                                            <!-- Totals Update -->
                                            <t t-set="line_no" t-value="line_no + 1"/>
                                            <t t-set="total_qty" t-value="total_qty + line.product_uom_qty"/>
                                            <t t-set="total_mw" t-value="total_mw + ((line.product_uom_qty * line.wattage) / 1000000)"/>
                                            <t t-set="calculated_untaxed" t-value="calculated_untaxed + line.price_subtotal"/>
                                            <t t-set="calculated_tax_amount" t-value="calculated_tax_amount + (line.price_total - line.price_subtotal)"/>
                                            <t t-set="calculated_total" t-value="calculated_total + line.price_total"/>
                                        </t>
                                        <!-- NEW: Show product notes and section lines underneath product lines -->
                                        <t t-elif="line.display_type in ('line_note', 'line_section')">
                                            <tr>
                                                <td colspan="13" class="value-cell" style="font-style: italic; background: #F8F8F8; white-space: pre-line;">
                                                    <strong>Note:- </strong><t t-esc="line.name"/>
                                                </td>
                                            </tr>
                                        </t>
                                    </t>

                                    <!-- Totals Row -->
                                    <tr class="value-cell" style="font-weight:bold; background-color:#E7E6E6;">
                                        <td colspan="7" class="label-cell text-right">Total</td>
                                        <td class="value-cell text-center"><t t-esc="'%.0f' % total_qty"/></td>
                                        <td class="value-cell text-center"><t t-esc="'%.2f' % total_mw"/></td>
                                        <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'{:,.2f}'.format(calculated_untaxed)"/></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'{:,.2f}'.format(calculated_tax_amount)"/></td>
                                        <td class="value-cell text-right" style="white-space: nowrap;">₹ <t t-esc="'{:,.2f}'.format(calculated_total)"/></td>
                                    </tr>

                                    <!-- Total Value -->
                                    <tr>
                                        <td colspan="12" class="label-cell text-right" style="border:1px solid #000;">Total Value</td>
                                        <td class="value-cell text-right" style="white-space: nowrap; border:1px solid #000;">
                                            ₹ <t t-esc="'{:,.2f}'.format(calculated_untaxed)"/>
                                        </td>
                                    </tr>

                                    <!-- Dynamic GST Computation -->
                                    <!-- Effective GST% for the whole order -->
                                    <t t-set="effective_gst_rate" t-value="calculated_untaxed and ((calculated_tax_amount / calculated_untaxed) * 100.0) or 0.0"/>
                                    <!-- Intrastate if company state equals partner state -->
                                    <t t-set="is_intrastate" t-value="o.partner_id.state_id and o.company_id.state_id and (o.partner_id.state_id.id == o.company_id.state_id.id)"/>

                                    <!-- GST Conditional Logic (Dynamic %) -->
                                    <t t-if="is_intrastate">
                                        <!-- Within same state: CGST + SGST -->
                                        <t t-set="calculated_half_tax" t-value="calculated_tax_amount / 2.0"/>
                                        <t t-set="half_rate" t-value="effective_gst_rate / 2.0"/>

                                        <tr>
                                            <td colspan="12" class="label-cell text-right" style="border:1px solid #000;">
                                                CGST (<t t-esc="('%0.2f' % half_rate).rstrip('0').rstrip('.')"/>%)
                                            </td>
                                            <td class="value-cell text-right" style="white-space: nowrap; border:1px solid #000;">
                                                ₹ <t t-esc="'{:,.2f}'.format(calculated_half_tax)"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="12" class="label-cell text-right" style="border:1px solid #000;">
                                                SGST (<t t-esc="('%0.2f' % half_rate).rstrip('0').rstrip('.')"/>%)
                                            </td>
                                            <td class="value-cell text-right" style="white-space: nowrap; border:1px solid #000;">
                                                ₹ <t t-esc="'{:,.2f}'.format(calculated_half_tax)"/>
                                            </td>
                                        </tr>
                                    </t>
                                    <t t-else="">
                                        <!-- Outside state: IGST -->
                                        <tr>
                                            <td colspan="12" class="label-cell text-right" style="border:1px solid #000;">
                                                IGST (<t t-esc="('%0.2f' % effective_gst_rate).rstrip('0').rstrip('.')"/>%)
                                            </td>
                                            <td class="value-cell text-right" style="white-space: nowrap; border:1px solid #000;">
                                                ₹ <t t-esc="'{:,.2f}'.format(calculated_tax_amount)"/>
                                            </td>
                                        </tr>
                                    </t>

                                    <!-- Final Total -->
                                    <tr style="font-weight:bold;">
                                        <td colspan="12" class="label-cell text-right" style="border:1px solid #000;">Total</td>
                                        <td class="value-cell text-right" style="white-space: nowrap; border:1px solid #000;">
                                            ₹ <t t-esc="'{:,.2f}'.format(calculated_total)"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <table class="excel-table" style="width:100%; border-collapse:collapse;">
                                <tr>
                                    <td class="label-cell">Amount in Words :</td>
                                    <td colspan="11" class="value-cell">
                                        <t t-esc="o.amount_to_text(calculated_total, 'INR')"/> Only
                                    </td>
                                </tr>
                            </table>
                            <!-- Bank Details -->
                            <style type="text/css">
                                .note-content p {
                                    margin: 0;
                                }
                            </style>

                            <table class="excel-table" style="width:100%; border-collapse: collapse; border: 1px solid #000;">
                                <thead>
                                    <tr>
                                        <td colspan="3" class="section-header" style="text-align:center; padding:4px;">Bank Details</td>
                                        <td colspan="1" class="section-header" style="text-align:center; padding:4px;">Special Instructions</td>
                                    </tr>
                                    <tr>
                                        <td class="label-cell" style="width:5%; text-align:center; border-right:1px solid #000; padding:4px;">Sr #</td>
                                        <td class="label-cell" style="width:10%; border-right:1px solid #000; padding:4px;">Particulars</td>
                                        <td class="label-cell" style="width:25%; border-right:1px solid #000; padding:4px;">Details</td>
                                        
                                        <td class="value-cell" style="width:45%; border-left:1px solid #000; padding:4px; font-weight:bold;">
                                            <span t-esc="o.order_line[0].name if o.order_line else ''"/>
                                        </td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="border-top:1px solid #000;">
                                        <td class="value-cell" style="text-align:center; border-right:1px solid #000; padding:4px;">1</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">Bank Name</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">
                                            <span t-esc="o.company_id.bank_name"/>
                                        </td>
                                        <td class="value-cell" style="padding:4px;">
                                            <span t-esc="dict(o._fields['special_instruction_dcr'].selection).get(o.special_instruction_dcr, '') if o.special_instruction_dcr else ''"/>
                                        </td>
                                    </tr>
                                    <tr style="border-top:1px solid #000;">
                                        <td class="value-cell" style="text-align:center; border-right:1px solid #000; padding:4px;">2</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">Account Name</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">
                                            <span t-esc="o.company_id.bank_ac_name"/>
                                        </td>
                                        <td class="value-cell" style="padding:4px;">
                                            <span t-esc="dict(o._fields['special_instruction_mess'].selection).get(o.special_instruction_mess, '') if o.special_instruction_mess else ''"/>
                                        </td>
                                    </tr>
                                    <tr style="border-top:1px solid #000;">
                                        <td class="value-cell" style="text-align:center; border-right:1px solid #000; padding:4px;">3</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">Account Number</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">
                                            <span t-esc="o.company_id.bank_ac_no"/>
                                        </td>
                                        <td class="value-cell" style="padding:4px;">
                                            Note
                                        </td>
                                    </tr>
                                    <tr style="border-top:1px solid #000;">
                                        <td class="value-cell" style="text-align:center; border-right:1px solid #000; padding:4px;">4</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">IFSC Code</td>
                                        <td class="value-cell" style="border-right:1px solid #000; padding:4px;">
                                            <span t-esc="o.company_id.bank_branch_ifsc"/>
                                        </td>
                                        <td class="value-cell note-content" style="vertical-align: top; padding:4px;">
                                            <span t-field="o.note" t-options="{'widget':'html'}"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        
                            <table class="excel-table" style="width:100%; border-collapse: collapse; border: 1px solid #000;">
                                <thead>
                                    <tr>
                                        <td colspan="6" class="section-header">Commercial Terms</td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="label-cell">
                                            <strong>Payment Terms</strong>
                                        </td>
                                        <td colspan="2" class="value-cell">
                                            <span t-esc="o.payment_term_id.name if o.payment_term_id else ''"/>
                                        </td>
                                        <td class="label-cell"><strong>Packing Type</strong></td>
                                        <td colspan="2" class="value-cell">
                                            <span>Standard Export Packing</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="label-cell"><strong>Delivery Type</strong></td>
                                        <td colspan="2" class="value-cell">
                                            <span t-if="o.delivery_type == 'for'">FOR</span>
                                            <span t-if="o.delivery_type == 'ex_works'">Ex. Works</span>
                                            <span t-if="not o.delivery_type">-</span>
                                        </td>
                                        <td class="label-cell"><strong>Delivery Location</strong></td>
                                        <td colspan="2" class="value-cell">
                                            <t t-if="o.partner_shipping_id">
                                                <span t-if="o.partner_shipping_id.city" t-esc="o.partner_shipping_id.city"/>
                                                <span t-if="o.partner_shipping_id.city and o.partner_shipping_id.state_id">, </span>
                                                <span t-if="o.partner_shipping_id.state_id" t-esc="o.partner_shipping_id.state_id.name"/>
                                                <t t-if="not (o.partner_shipping_id.city or o.partner_shipping_id.state_id)">
                                                    <span t-esc="o.partner_shipping_id.name"/>
                                                </t>
                                            </t>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="label-cell"><strong>Offer Validity</strong></td>
                                        <td colspan="2" class="value-cell">
                                            <t t-if="o.offer_validity">
                                                <span t-field="o.offer_validity"
                                                    t-options='{"widget": "datetime", "format": "dd-MM-yyyy"}'/>
                                            </t>
                                        </td>
                                        <td class="label-cell"><strong>Delivery Schedule</strong></td>
                                        <td colspan="2" class="value-cell">
                                            <span>As per mutual agreement</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="report-footer">
                                <table class="excel-table" style="width:100%; border-collapse: collapse; border: 1px solid #000; text-align: center;">
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #000;">
                                            <td colspan="2" style="width:33.33%; padding:4px; border-right: 1px solid #000;">
                                                <strong>Prepared By</strong>
                                            </td>
                                            <td colspan="2" style="width:33.33%; padding:4px; border-right: 1px solid #000;">
                                                <strong>Approved By</strong>
                                            </td>
                                            <td colspan="2" style="width:33.33%; padding:4px;">
                                                <strong>For <t t-esc="o.company_id.name"/></strong>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #000;">
                                            <td colspan="2" style="height: 29px; border-right: 1px solid #000;"></td>
                                            <td colspan="2" style="height: 29px; border-right: 1px solid #000;"></td>
                                            <td colspan="2" style="height: 29px;"></td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #000;">
                                            <td colspan="2" style="padding:4px; border-right: 1px solid #000;">
                                                Executive - Sales
                                            </td>
                                            <td colspan="2" style="padding:4px; border-right: 1px solid #000;">
                                                Head - Sales and Marketing
                                            </td>
                                            <td colspan="2" style="padding:4px;">
                                                <i style="text-decoration: underline;">Authorised Signatory</i>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="label-cell" style="width:12%; border-right:1px solid #000; padding:4px;">Revision No</td>
                                            <td class="value-cell" style="width:21.33%; border-right:1px solid #000; padding:4px; text-align:left;">00</td>
                                            <td class="label-cell" style="width:12%; border-right:1px solid #000; padding:4px;">Revision Date</td>
                                            <td class="value-cell" style="width:21.33%; border-right:1px solid #000; padding:4px; text-align:left;">NA</td>
                                            <td class="label-cell" style="width:12%; border-right:1px solid #000; padding:4px;">Confidentiality</td>
                                            <td class="value-cell" style="width:21.33%; padding:4px; text-align:left;">Internal Use / Customer Shared</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                    </div> 


                    <div class="page-break"/>

                    <div class="page">
                        
                            <table style="width: 100%; border-collapse: collapse; font-family: Arial, sans-serif;">
                                <tr>
                                    <td style="width: 15%; text-align: left; vertical-align: top; height: 120%;" rowspan="3">
                                        <t t-if="print_type == 'quotation'">
                                            <img t-if="o.company_id.quotation_invoice_image" 
                                                t-att-src="image_data_uri(o.company_id.quotation_invoice_image)" 
                                                style="max-height: 85px; display: block;"/>
                                        </t>
                                        <t t-else="">
                                            <img t-if="o.company_id.sale_image" 
                                                t-att-src="image_data_uri(o.company_id.sale_image)" 
                                                style="max-height: 85px; display: block;"/>
                                        </t>   
                                    </td>
                                    <td style="width: 16%; font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Document No</td>
                                    <td style="width: 16%; font-size: 10px; border: 1px solid black; padding: 4px;">
                                        <span t-esc="o.name"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Issue Date</td>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px;">
                                        <span t-esc="o.date_order.strftime('%d-%m-%Y') if o.date_order else ''"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Effective Date</td>
                                    <td style="font-size: 10px; border: 1px solid black; padding: 4px;">
                                        <span t-esc="o.validity_date.strftime('%d-%m-%Y') if o.validity_date else ''"/>
                                    </td>
                                </tr>
                            </table>
                    
                            <table class="excel-table" style="width:100%; border-collapse:collapse; border:1px solid #000; margin-top: 10px;">
                                    <thead>
                                        <tr>
                                            <td colspan="2" class="section-header" style="text-align:center; font-weight:bold; padding:4px; border-bottom:1px solid #000;">
                                                Terms &amp; Conditions
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="width:3%; text-align:center; padding:1px; border-right:1px solid #000;">1</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    This quotation is valid for
                                                    <t t-if="o.offer_validity and o.start_date">
                                                        <t t-set="days_diff" t-value="(o.offer_validity.date() - o.start_date).days"/>
                                                        <strong>**<t t-esc="days_diff"/> days**</strong>
                                                    </t>
                                                    from the date of issuance unless extended in writing.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">2</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    Any change in government duties, taxes, or levies will be charged at actuals.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">3</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    Delivery shall be made as per the mutually agreed delivery schedule.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">4</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                   Transit insurance shall be borne by the buyer unless otherwise agreed. Modules will be packed in standard export-quality packaging suitable for safe transportation and handling.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">5</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                   Modules will be packed in standard export-quality packaging suitable for safe transportation and handling.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">6</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    Material is subject to pre-dispatch inspection (if required) at our facility. Any external damage during transit should be reported immediately to the transporter and Solitech within **48 hours** of delivery.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">7</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    Any external damage during transit should be reported immediately to the transporter and Solitech within **48 hours** of delivery.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">8</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    Solitech shall not be held responsible for delays or non-performance due to acts of God, war, strike, pandemics, natural disasters, or any other force majeure conditions beyond its control.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">9</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    Any legal dispute arising out of this transaction will fall under the jurisdiction of the
                                                    <strong>
                                                        <t t-esc="o.jurisdiction_state"/> courts only.
                                                    </strong>
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">10</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    All designs, specifications, and product data shared are confidential and remain the property of Solitech Green Energy Pvt. Ltd. They must not be disclosed or reproduced without written consent.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="text-align:center; padding:1px; border-right:1px solid #000;">11</td>
                                            <td style="padding:1px;">
                                                <p style="margin: 0; padding-bottom: 3px;">
                                                    All designs, specifications, and product data shared are confidential and remain the property of Solitech Green Energy Pvt. Ltd. They must not be disclosed or reproduced without written consent.
                                                </p>
                                            </td>
                                        </tr>
                                        <tr style="border-top:1px solid #000;">
                                            <td style="padding:2px; border-right:1px solid #000;"></td>
                                            <td style="padding:2px;"></td>
                                        </tr>
                                    </tbody>
                            </table>
                    
                            <div class="report-footer">
                                <table class="excel-table" style="width:100%; border-collapse: collapse; border: 1px solid #000; text-align: center; margin-top: 10px;">
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #000;">
                                            <td colspan="2" style="width:33.33%; padding:4px; border-right: 1px solid #000;">
                                                <strong>Prepared By</strong>
                                            </td>
                                            <td colspan="2" style="width:33.33%; padding:4px; border-right: 1px solid #000;">
                                                <strong>Approved By</strong>
                                            </td>
                                            <td colspan="2" style="width:33.33%; padding:4px;">
                                                <strong>For <t t-esc="o.company_id.name"/></strong>
                                            </td>
                                        </tr>

                                        <tr style="border-bottom: 1px solid #000;">
                                            <td colspan="2" style="height: 29px; border-right: 1px solid #000;"></td>
                                            <td colspan="2" style="height: 29px; border-right: 1px solid #000;"></td>
                                            <td colspan="2" style="height: 29px;"></td>
                                        </tr>

                                        <tr style="border-bottom: 1px solid #000;">
                                            <td colspan="2" style="padding:4px; border-right: 1px solid #000;">
                                                Executive - Sales
                                            </td>
                                            <td colspan="2" style="padding:4px; border-right: 1px solid #000;">
                                                Head - Sales and Marketing
                                            </td>
                                            <td colspan="2" style="padding:4px;">
                                                <i style="text-decoration: underline;">Authorised Signatory</i>
                                            </td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="label-cell" style="width:12%; border-right:1px solid #000; padding:4px;">Revision No</td>
                                            <td class="value-cell" style="width:21.33%; border-right:1px solid #000; padding:4px; text-align:left;">00</td>
                                            <td class="label-cell" style="width:12%; border-right:1px solid #000; padding:4px;">Revision Date</td>
                                            <td class="value-cell" style="width:21.33%; border-right:1px solid #000; padding:4px; text-align:left;">NA</td>
                                            <td class="label-cell" style="width:12%; border-right:1px solid #000; padding:4px;">Confidentiality</td>
                                            <td class="value-cell" style="width:21.33%; padding:4px; text-align:left;">Internal Use / Customer Shared</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                    </div> 
                </t>
            </t>
        </template>
    </data>
</odoo>