<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="export_quotation_report">
            <t t-call="web.basic_layout">
                <t t-foreach="docs" t-as="o">
                    <style>
                        .excel-table {
                            width: 100%;
                            border-collapse: collapse;
                            font-family: Arial, sans-serif;
                        }
                        .excel-table td, .excel-table th {
                            border: 1px solid #000;
                            padding: 4px 8px;
                            font-size: 11px;
                        }
                        .header-blue {
                            background-color: #4472C4;
                            color: white;
                            font-weight: bold;
                            text-align: center;
                            font-size: 16px;
                            padding: 10px;
                        }
                        .section-header {
                            background-color: #D9D9D9;
                            font-weight: bold;
                            text-align: center;
                            font-size: 12px;
                        }
                        .label-cell {
                            background-color: #F2F2F2;
                            font-weight: bold;
                            width: 15%;
                        }
                        .value-cell {
                            background-color: white;
                        }
                        .product-header {
                            background-color: #626362ff;
                            color: white;
                            font-weight: bold;
                            text-align: center;
                        }
                        .terms-header {
                            background-color: #626362ff;
                            font-weight: bold;
                            text-align: center;
                        }
                        .signature-box {
                            border: 1px solid #000;
                            min-height: 80px;
                            padding: 5px;
                            margin-top: 20px;
                        }
                        .page-break {
                            page-break-after: always;
                        }
                        .no-border {
                            border: none !important;
                        }
                        .text-center {
                            text-align: center;
                        }
                        .text-right {
                            text-align: right;
                        }
                        .bold {
                            font-weight: bold;
                        }
                    </style>

                    <div class="page">
                        <!-- Header with Company Name and Logo -->
                        <table style="width: 100%; border-collapse: collapse; font-family: Arial, sans-serif;">
                            <!-- Row 1 -->
                            <tr>
                                <!-- Column 1: Logo spanning 3 rows -->
                                <td style="width: 15%; text-align: left; vertical-align: middle; padding: 5px;" rowspan="3">
                                    <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="max-height: 60px;"/>
                                </td>

                                <!-- Column 2: Company Name spanning 2 rows -->
                                <td style="width: 55%; text-align: center; vertical-align: middle; background-color: #002060; color: white; font-weight: bold; font-size: 18px; padding: 8px;" rowspan="2">
                                    <span t-esc="o.company_id.name"/>
                                </td>

                                <!-- Column 3: Document No -->
                                <td style="width: 12%; font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Document No</td>
                                <td style="width: 13%; font-size: 10px; border: 1px solid black; padding: 4px;">
                                    <span t-esc="o.name"/>
                                </td>
                            </tr>

                            <!-- Row 2 -->
                            <tr>
                                <!-- Column 3: Issue Date -->
                                <td style="font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Issue Date</td>
                                <td style="font-size: 10px; border: 1px solid black; padding: 4px;">
                                    <span t-esc="o.date_order.strftime('%d-%m-%Y') if o.date_order else ''"/>
                                </td>
                            </tr>

                            <!-- Row 3 -->
                            <tr>
                                <!-- Column 2: Quotation Heading -->
                                <td style="text-align: center; font-size: 12px; font-weight: bold; border: 1px solid black; padding: 6px;">
                                    Quotation
                                </td>

                                <!-- Column 3: Effective Date -->
                                <td style="font-size: 10px; border: 1px solid black; padding: 4px; font-weight: bold;">Effective Date</td>
                                <td style="font-size: 10px; border: 1px solid black; padding: 4px;">
                                    <span t-esc="o.date_order.strftime('%d-%m-%Y') if o.date_order else ''"/>
                                </td>
                            </tr>
                        </table>


                        <!-- Company Details Section -->
                        <table class="excel-table" style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <td colspan="6" class="section-header">Company Details</td>
                            </tr>
                            <tr>
                                <td class="label-cell">Name</td>
                                <td class="value-cell"><t t-esc="o.company_id.name"/></td>

                                <td class="label-cell">GSTIN No</td>
                                <td class="value-cell"><t t-esc="o.company_id.vat or ''"/></td>

                                <td class="label-cell">Quotation #</td>
                                <td class="value-cell"><t t-esc="o.name"/></td>
                            </tr>
                            <tr>
                                <td class="label-cell" rowspan="3">Address</td>
                                <td class="value-cell" rowspan="3">
                                    <t t-if="o.company_id.street"><t t-esc="o.company_id.street"/>, </t>
                                    <t t-if="o.company_id.street2"><t t-esc="o.company_id.street2"/>, </t>
                                    <br/>
                                    <t t-if="o.company_id.city"><t t-esc="o.company_id.city"/>, </t>
                                    <t t-if="o.company_id.state_id"><t t-esc="o.company_id.state_id.name"/>, </t>
                                    <t t-if="o.company_id.zip"><t t-esc="o.company_id.zip"/></t>
                                </td>

                                <td class="label-cell">Sales Person</td>
                                <td class="value-cell"><t t-esc="o.user_id.name if o.user_id else ''"/></td>

                                <td class="label-cell">Quotation Date</td>
                                <td class="value-cell"><t t-esc="o.date_order.strftime('%d-%m-%Y') if o.date_order else ''"/></td>
                            </tr>
                            <tr>
                                <td class="label-cell">Contact No</td>
                                <td class="value-cell"><t t-esc="o.company_id.phone or ''"/></td>

                                <td class="label-cell" rowspan="2">Customer Reference</td>
                                <td class="value-cell" rowspan="2"><t t-esc="o.client_order_ref or ''"/></td>
                            </tr>
                            <tr>
                                <td class="label-cell">Email ID</td>
                                <td class="value-cell"><t t-esc="o.company_id.email or ''"/></td>
                            </tr>
                        </table>

                        <!-- Customer Details Section -->
                        <table class="excel-table" style="width:100%; border-collapse: collapse; margin-top: 0px;">
                            <tr>
                                <td colspan="6" class="section-header">Customer Details</td>
                            </tr>
                            <tr>
                                <td class="label-cell">Bill To</td>
                                <td colspan="2" class="value-cell">
                                    <t t-esc="o.partner_id.name"/>
                                </td>
                                <td class="label-cell">Ship To</td>
                                <td colspan="2" class="value-cell">
                                    <t t-esc="o.partner_shipping_id.name if o.partner_shipping_id else o.partner_id.name"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3" class="value-cell">
                                    <t t-if="o.partner_id.street"><t t-esc="o.partner_id.street"/>,</t>
                                    <t t-if="o.partner_id.street2"><t t-esc="o.partner_id.street2"/>,</t><br/>
                                    <t t-if="o.partner_id.city"><t t-esc="o.partner_id.city"/>,</t>
                                    <t t-if="o.partner_id.state_id"><t t-esc="o.partner_id.state_id.name"/>,</t>
                                    <t t-if="o.partner_id.zip"><t t-esc="o.partner_id.zip"/></t>
                                </td>
                                <td colspan="3" class="value-cell">
                                    <t t-if="o.partner_shipping_id">
                                        <t t-if="o.partner_shipping_id.street"><t t-esc="o.partner_shipping_id.street"/>,</t>
                                        <t t-if="o.partner_shipping_id.street2"><t t-esc="o.partner_shipping_id.street2"/>,</t><br/>
                                        <t t-if="o.partner_shipping_id.city"><t t-esc="o.partner_shipping_id.city"/>,</t>
                                        <t t-if="o.partner_shipping_id.state_id"><t t-esc="o.partner_shipping_id.state_id.name"/>,</t>
                                        <t t-if="o.partner_shipping_id.zip"><t t-esc="o.partner_shipping_id.zip"/></t>
                                    </t>
                                    <t t-if="not o.partner_shipping_id">
                                        <t t-if="o.partner_id.street"><t t-esc="o.partner_id.street"/>,</t>
                                        <t t-if="o.partner_id.street2"><t t-esc="o.partner_id.street2"/>,</t><br/>
                                        <t t-if="o.partner_id.city"><t t-esc="o.partner_id.city"/>,</t>
                                        <t t-if="o.partner_id.state_id"><t t-esc="o.partner_id.state_id.name"/>,</t>
                                        <t t-if="o.partner_id.zip"><t t-esc="o.partner_id.zip"/></t>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <td class="label-cell">GSTIN No</td>
                                <td class="value-cell"><span t-field="o.partner_id.vat"/></td>

                                <td class="label-cell">Contact Person</td>
                                <td class="value-cell"><t t-esc="(o.partner_shipping_id or o.partner_id).name"/></td>

                                <td colspan="2" class="label-cell">
                                    Supply Timeline Requirement
                                </td>
                            </tr>
                            <tr>
                                <td class="label-cell">PAN No</td>
                                <td class="value-cell"><span t-field="o.partner_id.l10n_in_pan"/></td>

                                <td class="label-cell">Contact No</td>
                                <td class="value-cell"><t t-esc="(o.partner_shipping_id or o.partner_id).phone"/></td>

                                <td class="label-cell">Delivery Start Date</td>
                                <td class="value-cell"><span t-field="o.date_order" t-options='{"widget": "date", "format": "dd-MM-yyyy"}'/></td>
                            </tr>
                            <tr>
                                <td class="label-cell">CIN No</td>
                                <td class="value-cell"><span t-field="o.partner_id.company_registry"/></td>

                                <td class="label-cell">Email ID</td>
                                <td class="value-cell"><t t-esc="(o.partner_shipping_id or o.partner_id).email"/></td>

                                <td class="label-cell">Delivery End Date</td>
                                <td class="value-cell"><span t-field="o.commitment_date" t-options='{"widget": "date", "format": "dd-MM-yyyy"}'/></td>
                            </tr>
                        </table>

                        <!-- Product & Pricing Details -->
                        <table class="excel-table" style="width:100%; border-collapse:collapse;">
                            <!-- Section header: total columns = 13 -->
                            <tr>
                                <td colspan="13" class="section-header">Product &amp; Pricing Details</td>
                            </tr>

                            <!-- Column headers (Module spans 2 columns) -->
                            <tr class="label-cell">
                                <td class="label-cell">Sr #</td>
                                <td class="label-cell" colspan="2">Module - Model Type</td>
                                <td class="label-cell">Technology</td>
                                <td class="label-cell">Wattage (Wp)</td>
                                <td class="label-cell">Unit Price (₹ per Wp)</td>
                                <td class="label-cell">Unit Price (₹ per Nos)</td>
                                <td class="label-cell">Quantity (Nos)</td>
                                <td class="label-cell">Quantity (MW)</td>
                                <td class="label-cell">Total Line Amount (₹)</td>
                                <td class="label-cell">GST Rate (%)</td>
                                <td class="label-cell">GST Amount (₹)</td>
                                <td class="label-cell">Total Amount (₹)</td>
                            </tr>

                            <!-- Init counters -->
                            <t t-set="line_no" t-value="1"/>
                            <t t-set="total_qty" t-value="0"/>
                            <t t-set="total_mw" t-value="0"/>
                            <t t-set="total_amount" t-value="0"/>
                            <t t-set="total_gst" t-value="0"/>
                            <t t-set="grand_total" t-value="0"/>

                            <!-- Lines -->
                            <t t-foreach="o.order_line" t-as="line">
                                <t t-if="not line.display_type and not line.product_id.extra_charges">
                                    <tr>
                                        <td class="value-cell text-center"><t t-esc="line_no"/></td>

                                        <!-- Module occupies two columns -->
                                        <td class="value-cell" colspan="2"><t t-esc="line.product_id.name"/></td>

                                        <td class="value-cell text-center"><t t-esc="line.product_id.barcode or 'N-Type TOPCon Bifacial'"/></td>
                                        <td class="value-cell text-center"><t t-esc="'590' if not line.product_id.barcode else line.product_id.barcode[:3]"/></td>

                                        <td class="value-cell text-right">₹ <t t-esc="'%.2f' % (line.price_unit / 590 * 1000) if line.price_unit else '0.00'"/></td>
                                        <td class="value-cell text-right">₹ <t t-esc="'%.2f' % line.price_unit"/></td>

                                        <td class="value-cell text-center"><t t-esc="'%.0f' % line.product_uom_qty"/></td>
                                        <td class="value-cell text-center"><t t-esc="'%.2f' % (line.product_uom_qty * 590 / 1000000)"/></td>

                                        <td class="value-cell text-right">₹ <t t-esc="'{:,.2f}'.format(line.price_subtotal)"/></td>

                                        <td class="value-cell text-center">
                                            <t t-set="tax_rate" t-value="0"/>
                                            <t t-foreach="line.tax_id" t-as="tax">
                                                <t t-set="tax_rate" t-value="tax_rate + tax.amount"/>
                                            </t>
                                            <t t-esc="'%.0f' % tax_rate"/>%
                                        </td>

                                        <td class="value-cell text-right">
                                            <t t-set="gst_amount" t-value="line.price_subtotal * tax_rate / 100"/>
                                            ₹ <t t-esc="'{:,.2f}'.format(gst_amount)"/>
                                        </td>

                                        <td class="value-cell text-right">₹ <t t-esc="'{:,.2f}'.format(line.price_subtotal + gst_amount)"/></td>
                                    </tr>

                                    <!-- Update totals -->
                                    <t t-set="line_no" t-value="line_no + 1"/>
                                    <t t-set="total_qty" t-value="total_qty + line.product_uom_qty"/>
                                    <t t-set="total_mw" t-value="total_mw + (line.product_uom_qty * 590 / 1000000)"/>
                                    <t t-set="total_amount" t-value="total_amount + line.price_subtotal"/>
                                    <t t-set="total_gst" t-value="total_gst + gst_amount"/>
                                    <t t-set="grand_total" t-value="grand_total + line.price_subtotal + gst_amount"/>
                                </t>
                            </t>

                            <!-- Empty rows to keep table height consistent (adjust count as needed) -->
                            <t t-if="line_no &lt;= 5">
                                <t t-foreach="range(line_no, 6)" t-as="i">
                                    <tr>
                                        <td class="value-cell text-center"><t t-esc="i"/></td>
                                        <td class="value-cell" colspan="2"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                        <td class="value-cell"></td>
                                    </tr>
                                </t>
                            </t>

                            <!-- Total Row (Total label spans first 7 HTML columns to align with Quantity columns) -->
                            <tr class="value-cell" style="font-weight:bold; background-color:#E7E6E6;">
                                <td colspan="7" class="label-cell text-right">Total</td>

                                <!-- Qty (Nos) -->
                                <td class="value-cell text-center"><t t-esc="'%.0f' % total_qty"/></td>

                                <!-- Qty (MW) -->
                                <td class="value-cell text-center"><t t-esc="'%.2f' % total_mw"/></td>

                                <!-- Total Line Amount -->
                                <td class="value-cell text-right">₹ <t t-esc="'{:,.2f}'.format(total_amount)"/></td>

                                <!-- GST Rate empty for totals -->
                                <td class="value-cell"></td>

                                <!-- Total GST -->
                                <td class="value-cell text-right">₹ <t t-esc="'{:,.2f}'.format(total_gst)"/></td>

                                <!-- Grand Total -->
                                <td class="value-cell text-right">₹ <t t-esc="'{:,.2f}'.format(grand_total)"/></td>
                            </tr>
                        </table>

                        <!-- Amount in Words (span remaining columns: 13 total, label + value spanning 12) -->
                        <table class="excel-table" style="width:100%; border-collapse:collapse;">
                            <tr>
                                <td class="label-cell">Amount in Words :</td>
                                <td colspan="12" class="value-cell">
                                    <t t-esc="o.amount_to_text(grand_total, 'INR')"/> Only
                                </td>
                            </tr>
                        </table>

                        <!-- Technical Specification -->
                        <table class="excel-table" style="width:100%; border-collapse:collapse; margin-top:10px;">
                            <tr>
                                <td colspan="2" class="section-header" style="text-align:center;">Technical Specifications</td>
                            </tr>
                            <tr>
                                <td style="width:88%; padding:0; vertical-align:top;">
                                    <table style="width:100%; border-collapse:collapse;">
                                        <tr>
                                            <td class="label-cell" style="width:6%; text-align:center; font-weight:bold;">Sr #</td>
                                            <td class="label-cell" style="width:22%; text-align:left; font-weight:bold;">Particulars</td>
                                            <td class="label-cell" style="width:72%; text-align:left; font-weight:bold;">Specifications</td>
                                        </tr>
                                        <tr>
                                            <td class="value-cell" style="text-align:center;">1</td>
                                            <td class="value-cell">Module Technology</td>
                                            <td class="value-cell"></td>
                                        </tr>
                                        <tr>
                                            <td class="value-cell" style="text-align:center;">2</td>
                                            <td class="value-cell">Dimensions</td>
                                            <td class="value-cell"></td>
                                        </tr>
                                        <tr>
                                            <td class="value-cell" style="text-align:center;">3</td>
                                            <td class="value-cell">Al. Frame Size</td>
                                            <td class="value-cell">
                                                <table style="width:100%; border-collapse:collapse;">
                                                    <tr>
                                                        <td style="width:50%; padding:4px 6px; border:none;">
                                                            <strong>Long Side</strong><br/>
                                                        </td>
                                                        <td style="width:50%; padding:4px 6px; border:none;">
                                                            <strong>Short Side</strong><br/>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="value-cell" style="text-align:center;">4</td>
                                            <td class="value-cell">Junction Box</td>
                                            <td class="value-cell"></td>
                                        </tr>
                                        <tr>
                                            <td class="value-cell" style="text-align:center;" rowspan="2">5</td>
                                            <td class="value-cell" rowspan="2">Warranty</td>
                                            <td class="value-cell"></td>
                                        </tr>
                                        <tr>
                                            <td class="value-cell"></td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="width:12%; vertical-align:top; padding:6px; border-left:1px solid #000;">
                                    <div class="label-cell" style="text-align:center; font-weight:bold; margin-bottom:6px;">Remarks</div>
                                    <div class="value-cell" style="min-height:20px;">
                                    </div>
                                </td>
                            </tr>
                        </table>


                        <!-- Commercial Terms -->
                        <table class="excel-table" style="width:100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <td colspan="2" class="section-header" style="text-align: center; font-weight: bold; padding: 8px; border: 1px solid #000; background-color: #d3d3d3;">
                                        Commercial Terms
                                    </td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="width:50%; padding: 5px; border: 1px solid #000;">
                                        <strong>Payment Terms</strong><br/>
                                        <span t-esc="o.payment_term_id.name if o.payment_term_id else ''"/>
                                    </td>
                                    <td style="width:50%; padding: 5px; border: 1px solid #000;">
                                        <strong>Packing Type</strong><br/>
                                        <span>Standard Export Packing</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:50%; padding: 5px; border: 1px solid #000;">
                                        <strong>Delivery Terms</strong><br/>
                                        <span t-esc="o.incoterm.name if o.incoterm else 'Ex-Works'"/>
                                    </td>
                                    <td style="width:50%; padding: 5px; border: 1px solid #000;">
                                        <strong>Delivery Location</strong><br/>
                                        <t t-if="o.partner_shipping_id">
                                            <span t-if="o.partner_shipping_id.city" t-esc="o.partner_shipping_id.city"/>
                                            <span t-if="o.partner_shipping_id.city and o.partner_shipping_id.state_id">, </span>
                                            <span t-if="o.partner_shipping_id.state_id" t-esc="o.partner_shipping_id.state_id.name"/>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:50%; padding: 5px; border: 1px solid #000;">
                                        <strong>Offer Validity</strong><br/>
                                        <span t-if="o.validity_date">Valid until <t t-esc="o.validity_date.strftime('%d-%m-%Y')"/></span>
                                        <span t-else="">15 days from quotation date</span>
                                    </td>
                                    <td style="width:50%; padding: 5px; border: 1px solid #000;">
                                        <strong>Delivery Schedule</strong><br/>
                                        <span>As per mutual agreement</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Terms & Conditions -->
                        <table class="excel-table" style="width:100%; border-collapse:collapse;">
                            <tr>
                                <td class="terms-header">Terms &amp; Conditions</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">
                                    1. This quotation is valid for 15 days from the date of issuance unless extended in writing.<br/>
                                    2. Any change in government duties, taxes, or levies will be charged at actuals.<br/>
                                    3. Delivery shall be made as per the mutually agreed delivery schedule.<br/>
                                    4. Transit insurance shall be borne by the buyer unless otherwise agreed.<br/>
                                    5. Modules will be packed in standard export-quality packaging suitable for safe transportation and handling.<br/>
                                    6. Material is subject to pre-dispatch inspection (if required) at our facility.<br/>
                                    7. Any external damage during transit should be reported immediately to the transporter and Solitech within 48 hours of delivery.<br/>
                                    8. Solitech shall not be held responsible for delays or non-performance due to acts of God, war, strike, pandemics, natural disasters, or any other force majeure conditions beyond its control.<br/>
                                    9. Any legal dispute arising out of this transaction will fall under the jurisdiction of the Surat, Gujarat courts only.<br/>
                                    10. All designs, specifications, and product data shared are confidential and remain the property of Solitech Green Energy Pvt. Ltd. They must not be disclosed or reproduced without written consent.<br/>
                                    11. Any changes to this quotation must be mutually agreed upon and documented in writing.<br/>
                                    <t t-if="o.note">
                                        <br/><b>Additional Notes:</b> <t t-esc="o.note"/>
                                    </t>
                                </td>
                            </tr>
                        </table>

                        <!-- Signature Section -->
                        <table class="excel-table" style="margin-top: 20px;">
                            <tr>
                                <td style="width: 33%; vertical-align: bottom; height: 100px;">
                                    <div style="border-top: 1px solid #000; margin-top: 60px;">
                                        <b>Prepared By</b><br/>
                                        Executive - Sales
                                    </div>
                                </td>
                                <td style="width: 33%; vertical-align: bottom; height: 100px;">
                                    <div style="border-top: 1px solid #000; margin-top: 60px;">
                                        <b>Approved By</b><br/>
                                        Head - Sales and Marketing
                                    </div>
                                </td>
                                <td style="width: 34%; vertical-align: bottom; height: 100px;">
                                    <div style="border-top: 1px solid #000; margin-top: 60px;">
                                        <b>For <t t-esc="o.company_id.name"/></b><br/>
                                        <br/>
                                        <i>Authorized Signatory</i>
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- Footer -->
                        <table class="excel-table" style="margin-top: 10px;">
                            <tr>
                                <td style="width: 25%;">Revision No: 00</td>
                                <td style="width: 25%;">Revision Date: NA</td>
                                <td style="width: 25%;">Confidentiality</td>
                                <td style="width: 25%;">Internal Use / Customer Shared</td>
                            </tr>
                        </table>
                    </div>
                </t>
            </t>
        </template>
    </data>
</odoo>